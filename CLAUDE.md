# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

A French language learning application with multiple components:

### Flashcard Trainers
1. **Simple trainer** (`simple/flashcards.py`) - Basic vocabulary practice with CSV-based word lists
2. **Current trainer** (`flashcards.py`) - Advanced version with SRS, typing modes, progress tracking, and interactive prompts

### Additional Components
3. **Conjugation trainer** (`conjugations.py`) - Verb conjugation practice for present, future, and passé composé tenses
4. **Master vocabulary** (`master_vocabulary.csv`) - Combined file with all vocabulary from individual CSVs with category tags
5. **CSV combiner** (`combine_csvs.py`) - Tool to regenerate master vocabulary file

## Running the Application

### Simple Flashcard Trainer
```bash
python simple/flashcards.py <csv_file> <direction>
```
- `<csv_file>`: Path to a CSV file (e.g., `flashcards.csv`, `verbs.csv`, `weather.csv`)
- `<direction>`: Either `french` or `english` (determines which language you're guessing)
  - `english`: Shows French word, you recall English translation
  - `french`: Shows English word, you recall French translation

Examples:
```bash
python simple/flashcards.py flashcards.csv english    # French → English
python simple/flashcards.py verbs.csv french          # English → French
python simple/flashcards.py weather.csv english       # Weather vocabulary
```

### Current Flashcard Trainer (Recommended)
```bash
python3 flashcards.py [csv_file] [options]
```
Advanced version with multiple features and **interactive prompts**:
- Automatically prompts for language direction (French→English or English→French)
- Interactively shows and lets you select categories
- Defaults to `master_vocabulary.csv` if no file specified

**Command-line options:**
- `--help`: Show detailed help message
- `--srs`: Spaced Repetition System (only shows cards due for review)
- `--mode=<mode>`: easy (multiple choice), medium (typing with fuzzy match), hard (exact typing), expert (timed)
- `--gender`: Practice masculine/feminine noun genders
- `--category=<cat>`: Pre-select category (skips interactive prompt)
- `--list-categories`: Show available categories and exit
- `--stats`: Show progress statistics and exit

Examples:
```bash
# Show help
python3 flashcards.py --help

# Interactive mode (simplest - just run it!)
python3 flashcards.py

# Interactive with SRS enabled
python3 flashcards.py --srs --mode=medium

# Specify file and options
python3 flashcards.py weather.csv --mode=hard

# Non-interactive with command-line category
python3 flashcards.py --category=verbs --srs

# View available categories
python3 flashcards.py --list-categories
```

### Conjugation Trainer
```bash
python3 conjugations.py
```
Interactive menu allows selecting tense (present/future/passé composé) and tests random verb conjugations.

### Master Vocabulary Management
```bash
python3 combine_csvs.py
```
Combines all individual CSV files into `master_vocabulary.csv` with category tags. Run this whenever you update individual CSV files.

## CSV Data Structure

### Individual Vocabulary Files
Standard format (2 columns):
- **No header row**
- **Format**: `french_word,english_translation`
- **UTF-8 encoding** (supports French accents)

Example:
```csv
bonjour,hello
chat,cat
livre,book
```

Optional 3-column format with gender:
```csv
chat,cat,m
maison,house,f
```

### Master Vocabulary File
Combined format (3-4 columns):
- **Format**: `french,english,category[,gender]`
- Category is auto-generated from source filename
- Generated by `combine_csvs.py`

Example:
```csv
bonjour,hello,flashcards
il pleut,it's raining,weather
aimer,to like,verbs
```

### Available Vocabulary Files
- `flashcards.csv` - General vocabulary
- `verbs.csv` - Infinitive verbs
- `weather.csv` - Weather-related terms
- `clothing.csv` - Clothing vocabulary
- `locations.csv` - Places and locations
- `prepositions.csv` - Prepositions
- `questions.csv` - Question words/phrases
- `routine.csv` - Daily routine vocabulary
- `freq_words.csv` - Frequently used words
- `missed.csv` - Auto-generated file tracking incorrectly recalled flashcards

## Code Architecture

### simple/flashcards.py
- **Entry point**: `main()` function
- **Flow**: load_cards() → shuffle → [english_study() OR french_study()] → save_missed()
- **Key behavior**:
  - Missed cards are appended to `missed.csv` (preserves existing entries)
  - If perfect score, clears `missed.csv`
  - Language direction controls UI prompts and card presentation order
  - Uses command-line arguments (position-based, not flags)
- **Purpose**: Simple, lightweight version for basic flashcard practice

### flashcards.py
- **Enhanced features**: SRS algorithm, typing modes, progress tracking, category filtering, interactive prompts
- **Interactive UI**: Prompts for language direction and category selection on startup
- **Data persistence**: Uses `.flashcard_data/` directory for storing:
  - `card_stats.json`: Per-card SRS data (review intervals, ease factors, due dates)
  - `progress.json`: Session history, streaks, overall statistics
- **Card class**: Supports french, english, category, and gender fields
- **Multiple study modes**: Multiple choice, typing (fuzzy/exact), timed challenges
- **Spaced Repetition**: Simplified SM-2 algorithm with quality ratings (0-3)
- **Category filtering**: Interactive selection or command-line specification
- **Help system**: Built-in `--help` flag for detailed usage information
- **Backward compatible**: Works with all existing CSV formats (2, 3, or 4 columns)

### conjugations.py
- **Data-driven design**: Three dictionaries (PRESENT, FUTURE, PAST_COMPOSE) contain conjugation tables
- **Verb coverage**: être, avoir, aller, faire, parler, finir, savoir, connaître, venir, vouloir, pouvoir, devoir
- **Passé composé structure**: Stored as tuples `(auxiliary_verb, [participle_forms])`
  - Auxiliary is either "être" or "avoir"
  - get_table() dynamically builds full conjugations from auxiliary + participle
- **Interactive loop**: User selects tense, random verb chosen, all 6 pronouns tested

### combine_csvs.py
- **Purpose**: Combines all individual CSV files into master_vocabulary.csv
- **Process**: Reads all CSVs, adds category column (from filename), removes duplicates
- **Duplicate detection**: Based on matching french + english text (case-insensitive)
- **Output**: Creates master_vocabulary.csv with format: french,english,category[,gender]
- **Safe to re-run**: Overwrites master file each time, excludes missed.csv and master_vocabulary.csv itself

## Development Notes

- **Python version**: Requires Python 3.13+ (see `pyproject.toml`)
- **Dependencies**: `spyder-kernels>=3.1.0` (for development environment)
- **Package manager**: Uses `uv` (see `uv.lock`)
- **No tests**: Currently no test suite
- **main.py**: Placeholder file, not used

## Common Workflows

### Adding New Vocabulary
1. Add words to existing CSV file OR create new CSV file
2. Regenerate master file: `python3 combine_csvs.py`
3. Practice new words: `python3 flashcards.py master_vocabulary.csv english --srs`

### Adding Verbs to Conjugation Trainer
1. Add entries to PRESENT, FUTURE, and PAST_COMPOSE dictionaries in `conjugations.py`
2. For passé composé, specify correct auxiliary verb ("être" or "avoir")
3. Ensure all 6 pronoun forms are included in correct order: je, tu, il/elle/on, nous, vous, ils/elles

### Recommended Daily Practice
```bash
# Check what's due today
python3 flashcards.py --stats

# Interactive practice with SRS (simplest!)
python3 flashcards.py --srs

# Or pre-select category without prompts
python3 flashcards.py --category=verbs --srs
```

### Resetting Progress
Delete `.flashcard_data/` directory to reset all SRS data and statistics
